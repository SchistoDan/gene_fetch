2025-07-07 13:16:38,621 [INFO] Logging initialised. Log file: test_samples/gene_fetch.log
2025-07-07 13:16:38,637 [INFO] Using protein-coding search terms for cox1
2025-07-07 13:16:38,638 [INFO] Output directory: test_samples
2025-07-07 13:16:38,638 [INFO] Sequence type: both
2025-07-07 13:16:38,668 [INFO] Starting gene fetch for cox1 using taxids from ./data/samples.csv
2025-07-07 13:16:38,673 [INFO] 
2025-07-07 13:16:38,674 [INFO] CSV header detected: ['ID', 'taxid']
2025-07-07 13:16:38,675 [INFO] Header column 0: 'ID'
2025-07-07 13:16:38,676 [INFO] Header column 1: 'taxid'
2025-07-07 13:16:38,677 [INFO] Found matching column: ID
2025-07-07 13:16:38,678 [INFO] 
2025-07-07 13:16:38,679 [INFO] Starting processing: 0/3 samples processed (0%)
2025-07-07 13:16:38,680 [INFO] 
2025-07-07 13:16:38,681 [INFO] ====== Processing sample 1/3: sample-1 (taxID: 177658) ======
2025-07-07 13:16:38,682 [INFO] Retrieving taxonomy details from NCBI for taxID: 177658
2025-07-07 13:16:39,899 [INFO] Successfully retrieved taxonomy information from NCBI for taxID: 177658
2025-07-07 13:16:39,901 [INFO] Attempting search at genus level: Apatania (taxid: 177658)
2025-07-07 13:16:39,901 [INFO] Searching protein database at rank genus (Apatania) with term: (cox1[Gene] OR COI[Gene] OR "cytochrome c oxidase subunit 1"[Protein Name] OR "cytochrome oxidase subunit 1"[Protein Name] OR "cytochrome c oxidase subunit I"[Protein Name] OR "COX1"[Protein Name] OR "COXI"[Protein Name]) AND txid177658[Organism:exp] AND 500:10000[SLEN]
2025-07-07 13:16:41,290 [INFO] Found 1 protein records
2025-07-07 13:16:41,291 [INFO] Processing 1 protein record
2025-07-07 13:16:41,292 [INFO] Attempting to fetch protein sequence for cox1 (GI:571032513)
2025-07-07 13:16:42,379 [INFO] ***Successfully fetched protein sequence: Length 510 (accession AHF21732.1)
2025-07-07 13:16:42,380 [INFO] Attempting to fetch nucleotide sequence from protein record AHF21732.1
2025-07-07 13:16:42,381 [INFO] Parsing coded_by qualifier: KF756944.1:<832..2362
2025-07-07 13:16:42,382 [INFO] Successfully parsed coordinates: 832-2362 for KF756944.1
2025-07-07 13:16:42,383 [INFO] Fetching nucleotide sequence for accession: KF756944.1
2025-07-07 13:16:43,087 [INFO] ***Successfully extracted nucleotide sequence: Length 1531 (from protein record: AHF21732.1)
2025-07-07 13:16:43,088 [INFO] Search completed! Matched at rank: genus:Apatania
2025-07-07 13:16:43,089 [INFO] SELECTED SEQUENCE: AHF21732.1: Length 510aa
2025-07-07 13:16:43,096 [INFO] Written protein sequence to 'test_samples/protein/sample-1.fasta'
2025-07-07 13:16:43,097 [INFO] SELECTED SEQUENCE: KF756944.1: Length 1531bp
2025-07-07 13:16:43,100 [INFO] Written nucleotide sequence to 'test_samples/nucleotide/sample-1.fasta'
2025-07-07 13:16:44,055 [INFO] 
2025-07-07 13:16:44,056 [INFO] ====== Processing sample 2/3: sample-2 (taxID: 177627) ======
2025-07-07 13:16:44,058 [INFO] Retrieving taxonomy details from NCBI for taxID: 177627
2025-07-07 13:16:45,346 [INFO] Successfully retrieved taxonomy information from NCBI for taxID: 177627
2025-07-07 13:16:45,347 [INFO] Attempting search at genus level: Agapetus (taxid: 177627)
2025-07-07 13:16:45,348 [INFO] Searching protein database at rank genus (Agapetus) with term: (cox1[Gene] OR COI[Gene] OR "cytochrome c oxidase subunit 1"[Protein Name] OR "cytochrome oxidase subunit 1"[Protein Name] OR "cytochrome c oxidase subunit I"[Protein Name] OR "COX1"[Protein Name] OR "COXI"[Protein Name]) AND txid177627[Organism:exp] AND 500:10000[SLEN]
2025-07-07 13:16:46,837 [INFO] Found 3 protein records
2025-07-07 13:16:46,839 [INFO] Processing 3 protein record
2025-07-07 13:16:46,840 [INFO] Attempting to fetch protein sequence for cox1 (GI:2363797191)
2025-07-07 13:16:47,440 [INFO] ***Successfully fetched protein sequence: Length 511 (accession UZZ43728.1)
2025-07-07 13:16:47,441 [INFO] Attempting to fetch nucleotide sequence from protein record UZZ43728.1
2025-07-07 13:16:47,443 [INFO] Parsing coded_by qualifier: OL677999.1:1416..2949
2025-07-07 13:16:47,444 [INFO] Successfully parsed coordinates: 1416-2949 for OL677999.1
2025-07-07 13:16:47,444 [INFO] Fetching nucleotide sequence for accession: OL677999.1
2025-07-07 13:16:48,579 [INFO] ***Successfully extracted nucleotide sequence: Length 1534 (from protein record: UZZ43728.1)
2025-07-07 13:16:48,581 [INFO] Search completed! Matched at rank: genus:Agapetus
2025-07-07 13:16:48,582 [INFO] SELECTED SEQUENCE: UZZ43728.1: Length 511aa
2025-07-07 13:16:48,584 [INFO] Written protein sequence to 'test_samples/protein/sample-2.fasta'
2025-07-07 13:16:48,585 [INFO] SELECTED SEQUENCE: OL677999.1: Length 1534bp
2025-07-07 13:16:48,589 [INFO] Written nucleotide sequence to 'test_samples/nucleotide/sample-2.fasta'
2025-07-07 13:16:49,238 [INFO] 
2025-07-07 13:16:49,240 [INFO] ====== Processing sample 3/3: sample-3 (taxID: 3084599) ======
2025-07-07 13:16:49,241 [INFO] Retrieving taxonomy details from NCBI for taxID: 3084599
2025-07-07 13:16:50,289 [INFO] Successfully retrieved taxonomy information from NCBI for taxID: 3084599
2025-07-07 13:16:50,290 [INFO] Attempting search at species level: Agapetus incertulus (taxid: 3084599)
2025-07-07 13:16:50,291 [INFO] Searching protein database at rank species (Agapetus incertulus) with term: (cox1[Gene] OR COI[Gene] OR "cytochrome c oxidase subunit 1"[Protein Name] OR "cytochrome oxidase subunit 1"[Protein Name] OR "cytochrome c oxidase subunit I"[Protein Name] OR "COX1"[Protein Name] OR "COXI"[Protein Name]) AND txid3084599[Organism:exp] AND 500:10000[SLEN]
2025-07-07 13:16:51,348 [INFO] Searching nucleotide database at rank species (Agapetus incertulus) with term: (cox1[Gene] OR COI[Gene] OR "cytochrome c oxidase subunit 1"[Protein Name] OR "cytochrome oxidase subunit 1"[Protein Name] OR "cytochrome c oxidase subunit I"[Protein Name] OR "COX1"[Protein Name] OR "COXI"[Protein Name]) AND txid3084599[Organism:exp] AND 1000:60000[SLEN]
2025-07-07 13:16:52,215 [INFO] No sequences found at species level (Agapetus incertulus), traversing up taxonomy
2025-07-07 13:16:54,017 [INFO] Attempting search at genus level: Agapetus (taxid: 177627)
2025-07-07 13:16:54,018 [INFO] Searching protein database at rank genus (Agapetus) with term: (cox1[Gene] OR COI[Gene] OR "cytochrome c oxidase subunit 1"[Protein Name] OR "cytochrome oxidase subunit 1"[Protein Name] OR "cytochrome c oxidase subunit I"[Protein Name] OR "COX1"[Protein Name] OR "COXI"[Protein Name]) AND txid177627[Organism:exp] AND 500:10000[SLEN]
2025-07-07 13:16:55,591 [INFO] Found 3 protein records
2025-07-07 13:16:55,592 [INFO] Processing 3 protein record
2025-07-07 13:16:55,593 [INFO] Attempting to fetch protein sequence for cox1 (GI:2363797191)
2025-07-07 13:16:56,499 [INFO] ***Successfully fetched protein sequence: Length 511 (accession UZZ43728.1)
2025-07-07 13:16:56,501 [INFO] Attempting to fetch nucleotide sequence from protein record UZZ43728.1
2025-07-07 13:16:56,502 [INFO] Parsing coded_by qualifier: OL677999.1:1416..2949
2025-07-07 13:16:56,503 [INFO] Successfully parsed coordinates: 1416-2949 for OL677999.1
2025-07-07 13:16:56,504 [INFO] Fetching nucleotide sequence for accession: OL677999.1
2025-07-07 13:16:57,199 [INFO] ***Successfully extracted nucleotide sequence: Length 1534 (from protein record: UZZ43728.1)
2025-07-07 13:16:57,200 [INFO] Search completed! Matched at rank: genus:Agapetus
2025-07-07 13:16:57,202 [INFO] SELECTED SEQUENCE: UZZ43728.1: Length 511aa
2025-07-07 13:16:57,206 [INFO] Written protein sequence to 'test_samples/protein/sample-3.fasta'
2025-07-07 13:16:57,207 [INFO] SELECTED SEQUENCE: OL677999.1: Length 1534bp
2025-07-07 13:16:57,213 [INFO] Written nucleotide sequence to 'test_samples/nucleotide/sample-3.fasta'
2025-07-07 13:16:57,216 [INFO] Processed: 3/3 samples processed (100%)
2025-07-07 13:16:57,821 [INFO] Processed: 3/3 samples processed (100%)
2025-07-07 13:16:57,823 [INFO] ***********************************************************
2025-07-07 13:16:57,824 [INFO]               ? ? ? Gene fetch complete ? ? ?              
2025-07-07 13:16:57,824 [INFO] ***********************************************************
